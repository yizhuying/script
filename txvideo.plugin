/**
*@file       ËÖæËÆØËßÜÈ¢ë
*@desp       Êú¨ËÑöÊú¨‰ªÖÈÄÇÁî®‰∫éËÖæËÆØËßÜÈ¢ëÂèä‰ΩìËÇ≤‰ºöÂëòÊØèÊó•Á≠æÂà∞Ôºå‰ªÖÊµãËØïLoon
*@env        txspCookie„ÄÅtxspRefreshCookie„ÄÅtxspRefreshBody„ÄÅdayOfGetMonthTicket„ÄÅisSkipTxspCheckIn„ÄÅisLottery
*@author     WowYiJiu
*@updated    2024-6-14
*@version    v1.0.1
*@link       https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/tenvideo.js

üåü ÁéØÂ¢ÉÂèòÈáèËØ¥Êòé
txspCookieÔºöËÖæËÆØËßÜÈ¢ëappÁöÑCookie
txspRefreshCookie„ÄÅtxspRefreshBodyÔºöËÖæËÆØËßÜÈ¢ëÁΩëÈ°µNewRefreshÊé•Âè£‰∏≠ÁöÑÊï∞ÊçÆÔºåÁî®Êù•Âà∑Êñ∞Cookie‰∏≠ÁöÑvqq_vusession
dayOfGetMonthTicketÔºöÊØèÊúàÂá†Âè∑È¢ÜÂèñÊØèÊúàÁêÉÁ•®ÔºåÈªòËÆ§‰∏∫ÊØèÊúà1Âè∑
isSkipTxspCheckInÔºöÂÄºÂüü[true, false] ÈªòËÆ§‰∏∫falseË°®Á§∫Ê≠£Â∏∏ËøõË°åËÖæËÆØËßÜÈ¢ë‰ºöÂëòÁ≠æÂà∞ÔºåÁî®‰∫éÁâπÊÆäÊÉÖÂÜµ‰∏ãÔºàË¥¶Âè∑ÈúÄË¶ÅËé∑ÂèñÁü≠‰ø°È™åËØÅÁ†ÅÊàñËÄÖÈúÄË¶ÅËøáÊªëÂùóÈ™åËØÅÁ†ÅÔºâÊó∂ÂºÄÂêØ
isLottery: ÂÄºÂüü[true, false] ÈªòËÆ§‰∏∫falseË°®Á§∫‰∏çÊäΩÂ•ñÔºåÊäΩÊäΩ‰πê‰∫é2024Âπ¥2Êúà29Êó•10ÁÇπ‰∏ãÁ∫øÔºåÂª∫ËÆÆ‰∏çÂºÄÂêØÔºåÂèçÊ≠£‰πüÊäΩ‰∏çÂà∞

‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ‚ùñ

ËØ¶ÁªÜÂäüËÉΩÔºö
üîµ ËÖæËÆØËßÜÈ¢ë‰ºöÂëòÁ≠æÂà∞È¢ÜVÂäõÂÄº
üîµ ËÖæËÆØ‰ΩìËÇ≤‰ºöÂëòÁ≠æÂà∞È¢ÜÁÉ≠Áà±ÂÄº
üîµ ËÖæËÆØ‰ΩìËÇ≤È¢ÜÂèñÊØèÊó•ÁêÉÁ•®
üîµ ËÖæËÆØ‰ΩìËÇ≤È¢ÜÂèñÊØèÊúàÁêÉÁ•®

üìå Ëé∑ÂèñCookieÔºöÔºàÈáçÂÜôÈúÄË¶ÅËé∑Âèñ3‰∏™ÂÄºÔºötxspCookie„ÄÅtxspRefreshCookie„ÄÅtxspRefreshBody)
- ËøõÂÖ•ËÖæËÆØËßÜÈ¢ëappÔºåÁÇπÂáªÂè≥‰∏ãËßíÊàëÁöÑÔºåÁÇπÂáªÂ§¥ÂÉè‰∏ãÁöÑËßÜÈ¢ëVIPËøõÂÖ•‰ºöÂëò‰∏≠ÂøÉÁúãÂà∞Á≥ªÁªüÊ∂àÊÅØÊèêÁ§∫Ëé∑ÂèñtxspCookieÊàêÂäüÂç≥ÂèØ
- ÊµèËßàÂô®ËøõÂÖ•ËÖæËÆØËßÜÈ¢ëÁΩëÈ°µÁâàÔºåÁôªÂΩïÂêéÂàáÊç¢ÊàêÊ°åÈù¢ÁâàÔºåÂà∑Êñ∞ÁΩëÈ°µÁúãÂà∞Á≥ªÁªüÊ∂àÊÅØÊèêÁ§∫Ëé∑ÂèñtxspRefreshCookie„ÄÅtxspRefreshBodyÊàêÂäüÂç≥ÂèØ
- Ëé∑ÂèñCookieÂêé, ËØ∑Â∞ÜCookieËÑöÊú¨Á¶ÅÁî®Âπ∂ÁßªÈô§‰∏ªÊú∫ÂêçÔºå‰ª•ÂÖç‰∫ßÁîü‰∏çÂøÖË¶ÅÁöÑMITM

üí¨ BoxJsËÆ¢ÈòÖÔºöhttps://raw.githubusercontent.com/WowYiJiu/Personal/main/WowYiJiu.box.json

‚öô ÈÖçÁΩÆ (Loon)
[MITM]
hostname = vip.video.qq.com, pbaccess.video.qq.com

[Script]
http-request https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList? script-path=https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/tenvideo.js, requires-body=true, timeout=10, tag=ËÖæËÆØËßÜÈ¢ëCookieËé∑Âèñ
http-request https://pbaccess.video.qq.com/trpc.videosearch.hot_rank.HotRankServantHttp/HotRankHttp script-path=https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/tenvideo.js, requires-body=true, timeout=10, tag=ËÖæËÆØËßÜÈ¢ëCookieËé∑Âèñ
http-request https://pbaccess.video.qq.com/trpc.video_account_login.web_login_trpc.WebLoginTrpc/NewRefresh script-path=https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/tenvideo.js, requires-body=true, timeout=10, tag=ËÖæËÆØËßÜÈ¢ëCookieËé∑Âèñ

cron "5 7 * * *" script-path=https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/tenvideo.js, tag=ËÖæËÆØËßÜÈ¢ëÁ≠æÂà∞
*/

const $ = new Env("ËÖæËÆØËßÜÈ¢ë");

let txspCookie = ($.isNode() ? process.env.txspCookie : $.getdata('txspCookie')) || "";
let txspRefreshCookie = ($.isNode() ? process.env.txspRefreshCookie : $.getdata('txspRefreshCookie')) || "";
let txspRefreshBody = ($.isNode() ? process.env.txspRefreshBody  : $.getdata('txspRefreshBody')) || "";
let dayOfGetMonthTicket = ($.isNode() ? process.env.dayOfGetMonthTicket : $.getdata('dayOfGetMonthTicket')) || 1;
let isSkipTxspCheckIn = $.isNode() ? process.env.isSkipTxspCheckIn : (($.getdata('isSkipTxspCheckIn') !== undefined && $.getdata('isSkipTxspCheckIn') !== '') ? JSON.parse($.getdata('isSkipTxspCheckIn')) : false);
let isLottery = $.isNode() ? process.env.isLottery : (($.getdata('isLottery') !== undefined && $.getdata('isLottery') !== '') ? JSON.parse($.getdata('isLottery')) : false);

const Notify = 1; //0‰∏∫ÂÖ≥Èó≠ÈÄöÁü•,1‰∏∫ÊâìÂºÄÈÄöÁü•,ÈªòËÆ§‰∏∫1
const notify = $.isNode() ? require("./sendNotify") : "";

let currentVersion = "v1.0.1", latestVersion = "";
let nickname = "";
let isTxspVip = false, isTxspSvip = false, isTxSportsVip = false, isTxSportsSvip = false;
let endTime = "", svipEndTime = "", txSportsEndTime = "", txSportsSvipEndTime = "";
let level = "", txSportsLevel = "";
let score = "", txSportsScore = "";
let month_received_score = "", month_limit = "";
let isTxspCheckIn = "", isTxSportsCheckIn = "";

let txspCookieKeys = ['app_ver', 'main_login', 'video_platform', 'vqq_access_token', 'vqq_appid', 'vqq_openid', 'vqq_vuserid', 'vqq_vusession'];
let txspRefreshCookieKeys = ['main_login', 'vqq_access_token', 'vqq_appid', 'vqq_openid', 'vqq_refresh_token', 'vqq_vusession'];

let originalInfo = $.info;
let originalWarn = $.warn;
let originalError = $.error;
let message = "";
$.desc = "";
$.info=function(message){originalInfo.call($,message);$.desc+=message+"\n"};$.warn=function(message){originalWarn.call($,message);$.desc+=message+"\n"};$.error=function(message){originalError.call($,message);$.desc+=message+"\n"};

if ((isGetCookie = typeof $request !== `undefined`)) {
	getCookie();
	$.done();
} else if (!$.isNode() && !txspCookie){
	$.msg($.name, "ÊÇ®Êú™Ëé∑ÂèñËÖæËÆØËßÜÈ¢ëCookie", "ÁÇπÂáªÊ≠§Êù°Ë∑≥ËΩ¨Âà∞ËÖæËÆØËßÜÈ¢ëËé∑ÂèñCookie", { 'open-url': 'tenvideo://', 'media-url': 'https://raw.githubusercontent.com/WowYiJiu/Personal/main/icon/videoqq.png' });
	$.done();
} else {
	!(async () => {
		$.log(`                               _  _ _         `);
		$.log(`  __      _______      ___   _(_)(_|_)_   _   `);
		$.log(`  \\ \\ /\\ / / _ \\ \\ /\\ / / | | | || | | | | |  `);
		$.log(`   \\ \V  \V / (_) \\ \V  \V /| |_| | || | | |_| |  `);
		$.log(`    \\_/\\_/ \\___/ \\_/\\_/  \\__, |_|/ |_|\\__,_|  `);
		$.log(`                         |___/ |__/           `);
		await getNotice();
		await getVersion();
		$.log(`\nÂΩìÂâçÁâàÊú¨Ôºö${currentVersion}  ÊúÄÊñ∞ÁâàÊú¨Ôºö${latestVersion}\n`);
		$.version = `\nÂΩìÂâçÁâàÊú¨Ôºö${currentVersion}  ÊúÄÊñ∞ÁâàÊú¨Ôºö${latestVersion}\n`;
		if(!txspCookie){
			$.warn(`Êú™Â°´ÂÜôtxspCookieÁéØÂ¢ÉÂèòÈáè`);
			return;
		}
		if ($.isNode()){
			txspCookie = extractValues(txspCookie, txspCookieKeys);
			txspRefreshCookie = extractValues(txspRefreshCookie, txspRefreshCookieKeys);
		}
		$.info("---- ÂºÄÂßã Âà∑Êñ∞vqq_vusession ----");
		await refresh_vqq_vusession();
		$.info(`--------- ÁªìÊùü ---------\n`);
		$.info(`Áî®Êà∑ÊòµÁß∞Ôºö${nickname}`);
		await getVipInfo();
		if (isTxspVip){
			$.info(`---- ËÖæËÆØËßÜÈ¢ëVIP‰ø°ÊÅØ ----`);
			if (isTxspSvip){
				$.info(`ÂΩìÂâçÊòØËÖæËÆØËßÜÈ¢ëSVIP`);
			} else {
				$.info(`ÂΩìÂâçÊòØËÖæËÆØËßÜÈ¢ëVIP`);
			}
			$.info(`ÂΩìÂâçÁ≠âÁ∫ßÔºö${level}`);
			$.info(`ÂΩìÂâçÊàêÈïøÔºö${score}`);
			if (isTxspSvip){
				$.info(`SVIPÂà∞ÊúüÊó∂Èó¥Ôºö${svipEndTime}`);
			}
			$.info(`VIPÂà∞ÊúüÊó∂Èó¥Ôºö${endTime}`);
			$.info(`--------- ÁªìÊùü ---------\n`);
		}
		if (isTxSportsVip){
			$.info(`--- ËÖæËÆØ‰ΩìËÇ≤VIP‰ø°ÊÅØ ---`);
			if (isTxSportsSvip){
				$.info(`ÂΩìÂâçÊòØËÖæËÆØ‰ΩìËÇ≤Ë∂ÖÁ∫ßVIP`);
			} else {
				$.info(`ÂΩìÂâçÊòØËÖæËÆØ‰ΩìËÇ≤VIP`);
			}
			$.info(`ÂΩìÂâçÁ≠âÁ∫ßÔºö${txSportsLevel}`);
			$.info(`ÂΩìÂâçÊàêÈïøÔºö${txSportsScore}`);
			if (isTxSportsSvip){
				$.info(`Ë∂ÖÁ∫ßVIPÂà∞ÊúüÊó∂Èó¥Ôºö${txSportsSvipEndTime}`);
			}
			$.info(`VIPÂà∞ÊúüÊó∂Èó¥Ôºö${txSportsEndTime}`);
			$.info(`--------- ÁªìÊùü ---------\n`);
		}
		if (!isSkipTxspCheckIn){
			await txspCheckIn();
			await txSportsCheckIn();
			if ($.time('dd') == dayOfGetMonthTicket){
				await getMonthTicket();
			}
			if (isLottery){
				await LotteryDraw();
			}
		}
		if ($.desc !== ""){
			$.msg($.name, "","", {
				"open-url": "tenvideo://",
				"media-url": "https://raw.githubusercontent.com/WowYiJiu/Personal/main/icon/videoqq.png"
			});
			if (Notify > 0) {
				notify.sendNotify($.name, $.desc);
			}
		}
	})();
	$.done();
}

function refresh_vqq_vusession(){
	return new Promise(resolve => {
		$.post({
			url: "https://pbaccess.video.qq.com/trpc.video_account_login.web_login_trpc.WebLoginTrpc/NewRefresh",
			headers: {
				'Cookie': txspRefreshCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			body: txspRefreshBody,
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`Âà∑Êñ∞vqq_vusessionÂ§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						for (const key of Object.keys(result.data)){
							if (txspCookieKeys.indexOf(key) !== -1){
								txspCookie = txspCookie.replace(new RegExp(`${key}=([^;]*)`), `${key}=${result.data[key]}`);
							}
						}
						nickname = result.data.nickname;
						$.info(`Âà∑Êñ∞vqq_vusessionÊàêÂäü\n`);
					} else {
						$.warn(`Âà∑Êñ∞vqq_vusessionÂ§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function getVipInfo(){
	return new Promise(resolve => {
		$.get({
			url: "https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList?isMain=true",
			headers: {
				'Cookie': txspCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`Ëé∑ÂèñVIP‰ø°ÊÅØÂ§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						isTxspVip = result.data.txsp_vip;
						isTxspSvip = result.data.txsp_svip;
						isTxSportsVip = result.data.txSports_vip;
						isTxSportsSvip = result.data.txSports_svip;
						endTime = result.data.endTime;
						svipEndTime = result.data.svipEndTime;
						txSportsEndTime = result.data.txSportsEndTime;
						txSportsSvipEndTime = result.data.txSportsSvipEndTime;
						level = result.data.level;
						txSportsLevel = result.data.txSportsLevel;
						score = result.data.score;
						txSportsScore = result.data.txSportsScore;
						month_received_score = result.data.month_received_score;
						month_limit = result.data.month_limit;
						$.info(`Ëé∑ÂèñVIP‰ø°ÊÅØÊàêÂäü\n`);
					} else {
						$.warn(`Ëé∑ÂèñVIP‰ø°ÊÅØÂ§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function txspCheckIn(){
	return new Promise(resolve => {
		$.post({
			url: "https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList",
			headers: {
				'Cookie': txspCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			body: '{"areaCode": 1, "areaId": 1, "isMain": true}',
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`ËÖæËÆØËßÜÈ¢ëÁ≠æÂà∞Â§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						isTxspCheckIn = result.data.isCheckIn;
						$.info(`ËÖæËÆØËßÜÈ¢ëÁ≠æÂà∞ÊàêÂäü\n`);
					} else {
						$.warn(`ËÖæËÆØËßÜÈ¢ëÁ≠æÂà∞Â§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function txSportsCheckIn(){
	return new Promise(resolve => {
		$.post({
			url: "https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList",
			headers: {
				'Cookie': txspCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			body: '{"areaCode": 1, "areaId": 2, "isMain": true}',
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`ËÖæËÆØ‰ΩìËÇ≤Á≠æÂà∞Â§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						isTxSportsCheckIn = result.data.isCheckIn;
						$.info(`ËÖæËÆØ‰ΩìËÇ≤Á≠æÂà∞ÊàêÂäü\n`);
					} else {
						$.warn(`ËÖæËÆØ‰ΩìËÇ≤Á≠æÂà∞Â§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function getMonthTicket(){
	return new Promise(resolve => {
		$.post({
			url: "https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList",
			headers: {
				'Cookie': txspCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			body: '{"areaCode": 1, "areaId": 3, "isMain": true}',
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`È¢ÜÂèñÊØèÊúàÁêÉÁ•®Â§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						$.info(`È¢ÜÂèñÊØèÊúàÁêÉÁ•®ÊàêÂäü\n`);
					} else {
						$.warn(`È¢ÜÂèñÊØèÊúàÁêÉÁ•®Â§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function LotteryDraw(){
	return new Promise(resolve => {
		$.post({
			url: "https://vip.video.qq.com/rpc/trpc.new_task_system.task_system.TaskSystem/ReadTaskList",
			headers: {
				'Cookie': txspCookie,
				'Referer': 'https://v.qq.com',
				'Content-Type': 'application/json'
			},
			body: '{"areaCode": 1, "areaId": 4, "isMain": true}',
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`ÊäΩÂ•ñÂ§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.errcode === 0 && result.errmsg === "OK") {
						$.info(`ÊäΩÂ•ñÊàêÂäü\n`);
					} else {
						$.warn(`ÊäΩÂ•ñÂ§±Ë¥•Ôºö${JSON.stringify(result)}`);
					}
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function extractValues(cookie, keys){
	let result = [];
	for (const key of keys){
		let regex = new RegExp(`${key}=([^;]*)`);
		let match = regex.exec(cookie);
		if (match){
			result.push(`${key}=${match[1]}`);
		}
	}
	return result.join("; ");
}

function getNotice(){
	return new Promise(resolve => {
		$.get({
			url: "https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/notice.json",
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`Ëé∑ÂèñÂÖ¨ÂëäÂ§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.notice){
						$.msg($.name, `ÂÖ¨Âëä`, `${result.notice}`);
					}
					$.info(`Ëé∑ÂèñÂÖ¨ÂëäÊàêÂäü\n`);
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function getVersion(){
	return new Promise(resolve => {
		$.get({
			url: "https://raw.githubusercontent.com/WowYiJiu/Personal/main/Script/version.json",
			timeout: 30000
		}, (error, response, data) => {
			try {
				if (error) {
					$.warn(`Ëé∑ÂèñÁâàÊú¨‰ø°ÊÅØÂ§±Ë¥•\n${JSON.stringify(error)}`);
				} else {
					let result = JSON.parse(data);
					if (result.version){
						latestVersion = result.version;
					}
					$.info(`Ëé∑ÂèñÁâàÊú¨‰ø°ÊÅØÊàêÂäü\n`);
				}
			} catch (e) {
				$.error(e);
			} finally {
				resolve();
			}
		});
	});
}

function Env(t, e) {
    class s {
        constructor(t) {
            this.env = t
        }
        send(t, e = "GET") {
            t = "string" == typeof t ? {
                url: t
            } : t;
            let s = this.get;
            return "POST" === e && (s = this.post), new Promise((e, i) => {
                s.call(this, t, (t, s, r) => {
                    t ? i(t) : e(s)
                })
            })
        }
        get(t) {
            return this.send.call(this.env, t)
        }
        post(t) {
            return this.send.call(this.env, t, "POST")
        }
    }
    return new class {
        constructor(t, e) {
            this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.encoding = "utf-8", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `üîî${this.name}, ÂºÄÂßã!`)
        }
        isNode() {
            return "undefined" != typeof module && !!module.exports
        }
        log(t, e) {
            this.logs = [...this.logs, "", t, e].filter(Boolean)
        }
        info(t) {
            this.log(t)
        }
        warn(t) {
            this.log(t)
        }
        error(t) {
            this.log(t)
        }
        getdata(t) {
            let e = this.getval(t);
            if (/^@/.test(t)) {
                const [, s, r] = /^@(.*?)\.(.*?)$/.exec(t), i = s ? this.getval(s) : "";
                if (i) {
                    try {
                        const t = JSON.parse(i);
                        e = t ? this.lodash_get(t, r, "") : e
                    } catch (t) {
                        e = ""
                    }
                }
            }
            return e
        }
        getval(t) {
            return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null
        }
        isSurge() {
            return "undefined" != typeof $httpClient && "undefined" != typeof $loon
        }
        isLoon() {
            return "undefined" != typeof $loon
        }
        isQuanX() {
            return "undefined" != typeof $task
        }
        done(t = {}) {
            const e = (new Date).getTime(), s = (e - this.startTime) / 1e3;
            this.log("", `üîî${this.name}, ÁªìÊùü! üïõ ${s} Áßí`), this.log(), (this.isSurge() || this.isLoon() || this.isQuanX()) && $done(t)
        }
    }(t, e)
}
